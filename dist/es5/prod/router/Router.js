/*! urlmanager 2016-03-30 */
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};!function(a,b){"function"==typeof define&&define.amd?define("router/MatchBinding",b):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=b():(a.UrlManager=a.UrlManager||{},a.UrlManager.MatchBinding=b())}(void 0,function(){function a(b,c){""===c?this.pattern=c=b.replace(/^\(\/\)/g,"").replace(/^\/|$/g,""):(this.pattern=b,c+=b),this.location=c.replace(/\((.*?)\)/g,"$1").replace(/^\/|$/g,"");var d=this.pattern.replace(a.ESCAPE_PARAM,"\\$&").replace(a.OPTIONAL_PARAM,"(?:$1)?").replace(a.NAMED_PARAM,function(a,b){return b?a:"([^/]+)"}).replace(a.SPLAT_PARAM,"(.*?)");this.patternRegExp=new RegExp("^"+d),this.routeHandler=[],this.leaveHandler=[],this.queryHandler=[],this.routes=[]}return a.prototype.onBind=function(){},a.prototype.setOnBind=function(a){this.onBind=a},a.prototype.rebind=function(){void 0!==this.onBind&&this.onBind()},a.prototype.setRoutes=function(a){return this.routes.push(a),this},a.prototype.getRoutes=function(){return this.routes},a.prototype.to=function(a){return this.routeHandler.push(a),this},a.prototype.leave=function(a){return this.leaveHandler.push(a),this},a.prototype.query=function(a){return this.queryHandler.push(a),this},a.prototype.remove=function(){return this.routes.splice(0,this.routes.length),this.routeHandler.splice(0,this.routeHandler.length),this.leaveHandler.splice(0,this.leaveHandler.length),this.queryHandler.splice(0,this.queryHandler.length),this},a.prototype.test=function(a){return this.patternRegExp.test(a)},a.prototype.getFragment=function(a){var b=this.applyParams(a);return a.replace(b,"")},a.prototype.applyParams=function(a){var b=this.pattern.replace(/\((.*?)\)/g,"$1").split("/"),c=a.split("/");return c.splice(0,b.length).join("/")},a.prototype.extractParams=function(a){var b=this.patternRegExp.exec(a).slice(1);return b.map(function(a){return a?decodeURIComponent(a):null})},a.prototype.setSubBinder=function(a){return this.subBinder=a,a},a.prototype.getSubBinder=function(){return this.subBinder},a.prototype.getHandler=function(){return this.routeHandler},a.prototype.getLeaveHandler=function(){return this.leaveHandler},a.prototype.getQueryHandler=function(){return this.queryHandler},a.OPTIONAL_PARAM=/\((.*?)\)/g,a.NAMED_PARAM=/(\(\?)?:\w+/g,a.SPLAT_PARAM=/\*\w+/g,a.ESCAPE_PARAM=/[\-{}\[\]+?.,\\\^$|#\s]/g,a}),function(a,b){"function"==typeof define&&define.amd?define("router/MatchBinder",["./MatchBinding"],b):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=b(require("./MatchBinding")):(a.UrlManager=a.UrlManager||{},a.UrlManager.MatchBinder=b(a.UrlManager.MatchBinding))}(void 0,function(a){function b(a,b,c,d){this.bindings=[],this.location=d||a||"",this.command=c,this.params=b}return b.prototype.match=function(a,b){"function"==typeof a&&(b=a,a=!1),""===a&&(a=!1);var c=this.getMatchBinding(a,this.location);this.bindings.push(c);var d=this.getSubBinder(this.location+(a||""));return c.setSubBinder(d),b&&b(d.match.bind(d)),c},b.prototype.getSubBinder=function(a){return new b(a)},b.prototype.getMatchBinding=function(b,c){return new a(b,c)},b.prototype.filter=function(a){return this.bindings.filter(function(b){return b.test(a)})},b.prototype.run=function(){this.command(this)},b}),function(a,b){"function"==typeof define&&define.amd?define("router/Router",["./MatchBinder"],b):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=b(require("./MatchBinder")):(a.UrlManager=a.UrlManager||{},a.UrlManager.Router=b(a.UrlManager.MatchBinder))}(void 0,function(a){function b(a){try{return decodeURIComponent(a.replace(/\+/g," "))}catch(b){return a}}function c(a,b){var c=a.split("&");c.forEach(function(a){var c=a.split("=");b(c.shift(),c.join("="))})}function d(a,b,c,d){var e,f=c.root.substring(0,c.root.length-d.length);return a=a||"",e=b===!0?this.serialize(c.query):b===!1?"":this.serialize(b),f+a+(0===e.length?"":"?"+e)}function e(){this.root=this.getBinder(),this.bindings=[]}return Array.prototype.equals=function(a){if(!a)return!1;if(this.length!=a.length)return!1;for(var b=0,c=this.length;c>b;b++)if(this[b]instanceof Array&&a[b]instanceof Array){if(!this[b].equals(a[b]))return!1}else if(this[b]!=a[b])return!1;return!0},e.prototype.getBinder=function(){return new a},e.prototype.match=function(a){a(this.root.match.bind(this.root))},e.prototype.trigger=function(a){if(this.started){var d=a.split("?",2),e={};d[1]&&c(d[1],function(a,c){c=b(c),e[a]?"string"==typeof e[a]?e[a]=[e[a],c]:e[a].push(c):e[a]=c});var f=d[0].replace(/^\/|$/g,""),g={root:f,query:e},h=[],i=!1;this.bindings.forEach(function(b){var c,d=b.pattern.replace(/\((.*?)\)/g,"$1").replace(/^\//,"").split("/"),e=b.location.split("/"),j=b.prevLoc.replace(/^\//,"").split("/"),k=function(a){var b=a.splice(e.length-d.length,d.length),c=j.splice(0,d.length);return!b.equals(c)};if(c=k(i||f.split("/"))){i=f.split("/").splice(0,e.length-d.length);var l=b.getLeaveHandler(),m=[];b.setOnBind(),this.applyHandler(l,m,g,a),h.push(b)}}.bind(this)),h.forEach(function(a){this.bindings.splice(this.bindings.indexOf(a),1)}.bind(this)),this.find(this.root,f,g)}},e.prototype.find=function(a,b,c){var d=a.filter(b);d.forEach(this.onBinding.bind(this,b,c))},e.prototype.execute=function(a){var b=a.location.split("/"),c=a.params.root.split("/"),d="/"+c.splice(b.length,c.length-b.length).join("/");this.find(a,d,a.params)},e.prototype.onBinding=function(b,c,d){d.setOnBind(this.onBinding.bind(this,b,c,d)),this.runHandler(b,c,d);var e=d.getFragment(b),f=d.getSubBinder();f&&f.bindings&&f.bindings.length>0&&this.find(f,e,c);var g=d.getRoutes();if(g&&g.length>0)for(;g.length>0;){var h=g[0],i=new a(d.getFragment(b),c,this.execute.bind(this),d.location);h(i),f.bindings=f.bindings.concat(i.bindings),g.shift()}},e.prototype.serialize=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},e.prototype.runHandler=function(a,b,c){if(-1===this.bindings.indexOf(c)){var d=c.getHandler(),e=c.extractParams(a);c.prevLoc=a,this.applyHandler(d,e,b,a),this.bindings.push(c)}var d=c.getQueryHandler();d&&this.applyHandler(d,[],b,a)},e.prototype.applyHandler=function(a,b,c,e){a&&a.length>0&&a.forEach(function(a){a.apply(this,b.concat({getQuery:function(){return c.query},getLocation:function(a,b){return d.call(this,a,b,c,e)}.bind(this)}))}.bind(this))},e.prototype.start=function(){this.started=!0},e.prototype.stop=function(){this.started=!1},e});