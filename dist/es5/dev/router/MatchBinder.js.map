{"version":3,"sources":["../../../es6/dev/router/MatchBinder.js"],"names":[],"mappings":"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","file":"MatchBinder.js","sourcesContent":["(function(root, factory) {\n\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define([\n            './MatchBinding'\n        ], factory);\n    } else if (typeof exports === 'object') {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('./MatchBinding'));\n    } else {\n        // Browser globals (root is window)\n        root.UrlManager = root.UrlManager || {};\n        root.UrlManager.MatchBinder = factory(root.UrlManager.MatchBinding);\n    }\n}(this, function(MatchBinding) {\n    'use strict';\n\n    class MatchBinder {\n        constructor(location, params, command) {\n            this.bindings = [];\n            this._activeBindings = [];\n            this.location = location || '';\n            this.command = command;\n            this.params = params;\n            this._active = false;\n\n        }\n\n        match(pattern, mapHandler) {\n            if (typeof pattern === 'function') {\n                mapHandler = pattern;\n                pattern = false;\n            }\n            if (pattern === '') {\n                pattern = false;\n            }\n            return this.getMatchBinding(pattern, mapHandler);\n        };\n\n        getMatchBinding(pattern, mapHandler) {\n            if (pattern) {\n                let binding = new MatchBinding(pattern, this.location, this);\n                binding.setSubBinder(MatchBinder, this.location + (pattern || ''), mapHandler);\n                this.bindings.push(binding);\n                return binding;\n            } else {\n                if (typeof mapHandler === 'function') {\n                    mapHandler(this.match.bind(this));\n                }\n                return {\n                    match: this.match.bind(this)\n                }\n            }\n        };\n\n        clearActive(params, location) {\n            let active = []\n            if (this.bindings.length > 0) {\n                this.bindings.forEach((binding)=> {\n                    active = active.concat(binding.clearActive(params, location));\n                });\n            }\n            return active;\n        };\n\n        checkStatus(matched, params) {\n            let status = []\n            if (this.bindings.length > 0) {\n                this.bindings.forEach((binding)=> {\n                    status = status.concat(binding.checkSegment(matched, params));\n                });\n            }\n            return status;\n        };\n\n        trigger(location, params, move) {\n            let matched = location.replace(/^\\/|$/g, '').split('/'),\n                status = this.checkStatus(matched, params);\n            if (status.length > 0) {\n                let index = 0;\n                status.forEach((fn)=> {\n                    fn((applied)=> {\n                        if (applied) {\n                            index++;\n                        } else if (move) {\n                            move(false);\n                        }\n                        if (status.length === index) {\n                            this.triggerRoutes(location, params);\n                            if (move) {\n                                move(true);\n                            }\n\n                        }\n                    });\n\n                });\n            } else {\n                this.triggerRoutes(location, params);\n                if (move) {\n                    move(true);\n                }\n            }\n\n        };\n\n        triggerRoutes(location, params) {\n            this.bindings.forEach(binding=>binding.triggerTo(location, params))\n\n        }\n\n        run() {\n            this.command(this);\n        };\n    }\n\n    return MatchBinder;\n}));\n"]}